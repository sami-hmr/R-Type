<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>r-type: include/plugin/Hooks.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">r-type<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_994ee0afe77535e0243d8facd5f6f306.html">plugin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Hooks.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Hook resolution and JSON value extraction functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;any&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;optional&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;type_traits&gt;</code><br />
<code>#include &lt;variant&gt;</code><br />
<code>#include &quot;Json/JsonParser.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="Registry_8hpp_source.html">ecs/Registry.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Hooks.hpp:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 --></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 1 --></div>
</div>
</div>
<p><a href="Hooks_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structis__in__json__variant.html">is_in_json_variant&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type trait to check if T is a valid JSON variant type.  <a href="structis__in__json__variant.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a978c2837387286f95b5dd502a61a74e3" id="r_a978c2837387286f95b5dd502a61a74e3"><td class="memTemplParams" colspan="2">template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; </td></tr>
<tr class="memitem:a978c2837387286f95b5dd502a61a74e3"><td class="memTemplItemLeft" align="right" valign="top">std::optional&lt; std::reference_wrapper&lt; const <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Hooks_8hpp.html#a978c2837387286f95b5dd502a61a74e3">get_ref</a> (<a class="el" href="classRegistry.html">Registry</a> &amp;r, JsonObject const &amp;object, std::string const &amp;key)</td></tr>
<tr class="memdesc:a978c2837387286f95b5dd502a61a74e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a const reference to a value from JSON, resolving hooks.  <br /></td></tr>
<tr class="separator:a978c2837387286f95b5dd502a61a74e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9a223334bc754df5bf32b6f41e5b31" id="r_adb9a223334bc754df5bf32b6f41e5b31"><td class="memTemplParams" colspan="2">template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> , typename... Args&gt; </td></tr>
<tr class="memitem:adb9a223334bc754df5bf32b6f41e5b31"><td class="memTemplItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Hooks_8hpp.html#adb9a223334bc754df5bf32b6f41e5b31">get_value_copy</a> (<a class="el" href="classRegistry.html">Registry</a> &amp;r, JsonObject const &amp;object, std::string const &amp;key, Args &amp;&amp;... args)</td></tr>
<tr class="memdesc:adb9a223334bc754df5bf32b6f41e5b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a copy of a value from JSON, supporting hooks and construction.  <br /></td></tr>
<tr class="separator:adb9a223334bc754df5bf32b6f41e5b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac691828d534a0e4dd453f2419b40c4bf" id="r_ac691828d534a0e4dd453f2419b40c4bf"><td class="memTemplParams" colspan="2">template&lt;typename ComponentType , typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> , typename... Args&gt; </td></tr>
<tr class="memitem:ac691828d534a0e4dd453f2419b40c4bf"><td class="memTemplItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Hooks_8hpp.html#ac691828d534a0e4dd453f2419b40c4bf">get_value</a> (<a class="el" href="classRegistry.html">Registry</a> &amp;r, JsonObject const &amp;object, <a class="el" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> entity, std::string const &amp;field_name, Args &amp;&amp;... args)</td></tr>
<tr class="memdesc:ac691828d534a0e4dd453f2419b40c4bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a value and registers a dynamic binding for auto-updates.  <br /></td></tr>
<tr class="separator:ac691828d534a0e4dd453f2419b40c4bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f31f364a4ef0cbffcdb592482c79562" id="r_a7f31f364a4ef0cbffcdb592482c79562"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a> (JsonObject const &amp;object, std::string const &amp;key)</td></tr>
<tr class="memdesc:a7f31f364a4ef0cbffcdb592482c79562"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a JSON value is a dynamic hook reference.  <br /></td></tr>
<tr class="separator:a7f31f364a4ef0cbffcdb592482c79562"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aba47387628b78f33fcb6471473b636d2" id="r_aba47387628b78f33fcb6471473b636d2"><td class="memTemplParams" colspan="2">template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; </td></tr>
<tr class="memitem:aba47387628b78f33fcb6471473b636d2"><td class="memTemplItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="Hooks_8hpp.html#aba47387628b78f33fcb6471473b636d2">is_in_json_variant_v</a> = <a class="el" href="structis__in__json__variant.html">is_in_json_variant</a>&lt;<a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a>&gt;::value</td></tr>
<tr class="memdesc:aba47387628b78f33fcb6471473b636d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience variable template for <a class="el" href="structis__in__json__variant.html" title="Type trait to check if T is a valid JSON variant type.">is_in_json_variant</a>.  <br /></td></tr>
<tr class="separator:aba47387628b78f33fcb6471473b636d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Hook resolution and JSON value extraction functions. </p>
<p>This file provides helper functions to extract values from JSON configuration while resolving hook references. Hooks enable JSON strings to reference component field values using special syntax (# for dynamic hooks, % for static hooks).</p>
<h1><a class="anchor" id="hooks_overview"></a>
Overview</h1>
<p>The hook system allows JSON configurations to reference runtime values:</p><ul>
<li><b>Direct values</b>: <code>"speed": 10</code> - literal number</li>
<li><b>Static hooks</b>: <code>"speed": "%PlayerConfig:maxSpeed"</code> - read once</li>
<li><b>Dynamic bindings</b>: <code>"target": "#Enemy:pos"</code> - live updates</li>
<li><b>Nested objects</b>: <code>"sprite": {"texture": "player.png", ...}</code> - construct from JSON</li>
</ul>
<h1><a class="anchor" id="hooks_syntax"></a>
Hook Syntax</h1>
<h2><a class="anchor" id="hooks_static"></a>
Static Hooks (%)</h2>
<p>Format: <code>"%ComponentName:fieldName"</code></p>
<ul>
<li>Prefix: % indicates static hook</li>
<li>Resolution: Read value once during initialization</li>
<li>Use case: Global configuration, template values</li>
<li>Binding: No dynamic binding registered</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;entity&quot;: {</div>
<div class="line">    &quot;components&quot;: {</div>
<div class="line">      &quot;Velocity&quot;: {</div>
<div class="line">        &quot;speed&quot;: &quot;%GameConfig:playerSpeed&quot;  // Read global config</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_dynamic"></a>
Dynamic Hooks (#)</h2>
<p>Format: <code>"#ComponentName:fieldName"</code></p>
<ul>
<li>Prefix: # indicates dynamic hook</li>
<li>Resolution: Read initial value and register binding</li>
<li>Use case: Data binding between components</li>
<li>Binding: Auto-updates when source changes</li>
</ul>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;follower&quot;: {</div>
<div class="line">    &quot;components&quot;: {</div>
<div class="line">      &quot;Follower&quot;: {</div>
<div class="line">        &quot;target&quot;: &quot;#Leader:pos&quot;  // Tracks leader&#39;s position</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_nested"></a>
Nested Fields</h2>
<p>Access sub-fields using colon separator:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;projectile&quot;: {</div>
<div class="line">    &quot;components&quot;: {</div>
<div class="line">      &quot;Velocity&quot;: {</div>
<div class="line">        &quot;speed.x&quot;: &quot;#Player:velocity.speed.x&quot;,  // Just the x component</div>
<div class="line">        &quot;speed.y&quot;: &quot;#Player:velocity.speed.y&quot;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="hooks_functions"></a>
Functions</h1>
<h2><a class="anchor" id="hooks_getref"></a>
get_ref&lt;T&gt;()</h2>
<p>Retrieves a const reference to a value from JSON, resolving hooks if present.</p>
<div class="fragment"><div class="line">JsonObject config = load_json(<span class="stringliteral">&quot;config.json&quot;</span>);</div>
<div class="line"><a class="code hl_class" href="classRegistry.html">Registry</a> r;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get direct value</span></div>
<div class="line"><span class="keyword">auto</span> speed_ref = get_ref&lt;double&gt;(r, config, <span class="stringliteral">&quot;speed&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (speed_ref) {</div>
<div class="line">  <span class="keywordtype">double</span> speed = speed_ref-&gt;get();  <span class="comment">// Dereference reference_wrapper</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get hooked value</span></div>
<div class="line"><span class="keyword">auto</span> pos_ref = get_ref&lt;Vector2D&gt;(r, config, <span class="stringliteral">&quot;position&quot;</span>);</div>
<div class="line"><span class="comment">// If config[&quot;position&quot;] = &quot;#Player:pos&quot;, returns ref to Player::pos</span></div>
<div class="ttc" id="aclassRegistry_html"><div class="ttname"><a href="classRegistry.html">Registry</a></div><div class="ttdoc">The Registry class is the core of the ECS (Entity-Component-System) architecture.</div><div class="ttdef"><b>Definition</b> Registry.hpp:348</div></div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_getvaluecopy"></a>
get_value_copy&lt;T&gt;()</h2>
<p>Retrieves a copy of a value, supporting hooks and JSON construction.</p>
<div class="fragment"><div class="line"><span class="comment">// Direct value</span></div>
<div class="line"><span class="keyword">auto</span> damage = get_value_copy&lt;int&gt;(r, event_obj, <span class="stringliteral">&quot;damage&quot;</span>);</div>
<div class="line"><span class="comment">// damage = 50</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Hook reference</span></div>
<div class="line"><span class="keyword">auto</span> pos = get_value_copy&lt;Vector2D&gt;(r, obj, <span class="stringliteral">&quot;position&quot;</span>);</div>
<div class="line"><span class="comment">// If obj[&quot;position&quot;] = &quot;%Spawn:pos&quot;, reads Spawn::pos</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// JSON construction</span></div>
<div class="line"><span class="keyword">auto</span> rect = get_value_copy&lt;Rect&gt;(r, obj, <span class="stringliteral">&quot;bounds&quot;</span>);</div>
<div class="line"><span class="comment">// If obj[&quot;bounds&quot;] = {&quot;x&quot;: 0, &quot;y&quot;: 0, &quot;w&quot;: 100, &quot;h&quot;: 50}</span></div>
<div class="line"><span class="comment">// Calls Rect(JsonObject) constructor</span></div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_getvalue"></a>
get_value&lt;ComponentType, T&gt;()</h2>
<p>Retrieves a value and optionally registers dynamic binding for auto-updates.</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> entity = r.<a class="code hl_function" href="classRegistry.html#a3afa81d52e66afd192bfb44f191c1510">spawn_entity</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Static hook (no binding)</span></div>
<div class="line"><span class="keyword">auto</span> init_pos = get_value&lt;Transform, Vector2D&gt;(</div>
<div class="line">  r, config, entity, <span class="stringliteral">&quot;spawn_pos&quot;</span></div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Dynamic binding (auto-updates)</span></div>
<div class="line"><span class="keyword">auto</span> target_pos = get_value&lt;Follower, Vector2D&gt;(</div>
<div class="line">  r, config, entity, <span class="stringliteral">&quot;target_pos&quot;</span></div>
<div class="line">);</div>
<div class="line"><span class="comment">// If config[&quot;target_pos&quot;] = &quot;#Leader:pos&quot;</span></div>
<div class="line"><span class="comment">// Registers binding: Follower.target_pos &lt;- Leader.pos</span></div>
<div class="line"><span class="comment">// Follower&#39;s target_pos updates when Leader moves</span></div>
<div class="ttc" id="aclassRegistry_html_a0f7878e7be2d225f4f7ca38b85911110"><div class="ttname"><a href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a></div><div class="ttdeci">std::size_t Entity</div><div class="ttdoc">Type alias for an entity identifier.</div><div class="ttdef"><b>Definition</b> Registry.hpp:356</div></div>
<div class="ttc" id="aclassRegistry_html_a3afa81d52e66afd192bfb44f191c1510"><div class="ttname"><a href="classRegistry.html#a3afa81d52e66afd192bfb44f191c1510">Registry::spawn_entity</a></div><div class="ttdeci">Entity spawn_entity()</div><div class="ttdoc">Spawns a new entity.</div><div class="ttdef"><b>Definition</b> Registry.cpp:11</div></div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_ishook"></a>
is_hook()</h2>
<p>Checks if a JSON key contains a dynamic hook reference.</p>
<div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;speed&quot;</span>] = 10;</div>
<div class="line">obj[<span class="stringliteral">&quot;target&quot;</span>] = <span class="stringliteral">&quot;#Enemy:pos&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;speed&quot;</span>);   <span class="comment">// false - literal value</span></div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;target&quot;</span>);  <span class="comment">// true - starts with #</span></div>
<div class="ttc" id="aHooks_8hpp_html_a7f31f364a4ef0cbffcdb592482c79562"><div class="ttname"><a href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a></div><div class="ttdeci">bool is_hook(JsonObject const &amp;object, std::string const &amp;key)</div><div class="ttdoc">Checks if a JSON value is a dynamic hook reference.</div><div class="ttdef"><b>Definition</b> Hooks.hpp:746</div></div>
</div><!-- fragment --><h1><a class="anchor" id="hooks_types"></a>
Type Support</h1>
<h2><a class="anchor" id="hooks_json"></a>
JSON-Compatible Types</h2>
<p>Direct value extraction supports JSON variant types:</p><ul>
<li>int</li>
<li>double</li>
<li>std::string</li>
<li>bool</li>
<li>JsonObject</li>
<li>JsonArray</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">auto</span> name = get_value_copy&lt;std::string&gt;(r, obj, <span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> health = get_value_copy&lt;int&gt;(r, obj, <span class="stringliteral">&quot;health&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> active = get_value_copy&lt;bool&gt;(r, obj, <span class="stringliteral">&quot;active&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_custom"></a>
Custom Types via Constructors</h2>
<p>Types with JsonObject constructors are automatically supported:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structRect.html">Rect</a> {</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structRect.html#ab16cf99e4fd6d21bca554a194b81ae02">x</a>, <a class="code hl_variable" href="structRect.html#a4293ce73030477ba38ed66200391aa97">y</a>, w, h;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="structRect.html">Rect</a>(JsonObject <span class="keyword">const</span>&amp; obj)</div>
<div class="line">    : <a class="code hl_variable" href="structRect.html#ab16cf99e4fd6d21bca554a194b81ae02">x</a>(obj.at(<span class="stringliteral">&quot;x&quot;</span>).value.get&lt;double&gt;())</div>
<div class="line">    , <a class="code hl_variable" href="structRect.html#a4293ce73030477ba38ed66200391aa97">y</a>(obj.at(<span class="stringliteral">&quot;y&quot;</span>).value.get&lt;double&gt;())</div>
<div class="line">    , w(obj.at(<span class="stringliteral">&quot;w&quot;</span>).value.get&lt;double&gt;())</div>
<div class="line">    , h(obj.at(<span class="stringliteral">&quot;h&quot;</span>).value.get&lt;double&gt;())</div>
<div class="line">  {}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// JSON: {&quot;bounds&quot;: {&quot;x&quot;: 10, &quot;y&quot;: 20, &quot;w&quot;: 100, &quot;h&quot;: 50}}</span></div>
<div class="line"><span class="keyword">auto</span> bounds = get_value_copy&lt;Rect&gt;(r, obj, <span class="stringliteral">&quot;bounds&quot;</span>);</div>
<div class="line"><span class="comment">// Automatically calls Rect(JsonObject) constructor</span></div>
<div class="ttc" id="astructRect_html"><div class="ttname"><a href="structRect.html">Rect</a></div><div class="ttdoc">Center-based rectangle with collision detection methods.</div><div class="ttdef"><b>Definition</b> Rect.hpp:22</div></div>
<div class="ttc" id="astructRect_html_a4293ce73030477ba38ed66200391aa97"><div class="ttname"><a href="structRect.html#a4293ce73030477ba38ed66200391aa97">Rect::y</a></div><div class="ttdeci">double y</div><div class="ttdoc">Center Y coordinate.</div><div class="ttdef"><b>Definition</b> Rect.hpp:24</div></div>
<div class="ttc" id="astructRect_html_ab16cf99e4fd6d21bca554a194b81ae02"><div class="ttname"><a href="structRect.html#ab16cf99e4fd6d21bca554a194b81ae02">Rect::x</a></div><div class="ttdeci">double x</div><div class="ttdoc">Center X coordinate.</div><div class="ttdef"><b>Definition</b> Rect.hpp:23</div></div>
</div><!-- fragment --><h1><a class="anchor" id="hooks_examples"></a>
Complete Examples</h1>
<h2><a class="anchor" id="hooks_enemy"></a>
Enemy Configuration</h2>
<div class="fragment"><div class="line">// config.json</div>
<div class="line">{</div>
<div class="line">  &quot;templates&quot;: {</div>
<div class="line">    &quot;EnemyDefaults&quot;: {</div>
<div class="line">      &quot;health&quot;: 100,</div>
<div class="line">      &quot;speed&quot;: 5.0</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;entities&quot;: {</div>
<div class="line">    &quot;boss&quot;: {</div>
<div class="line">      &quot;components&quot;: {</div>
<div class="line">        &quot;Health&quot;: {</div>
<div class="line">          &quot;max&quot;: &quot;%EnemyDefaults:health&quot;,  // Static: read once</div>
<div class="line">          &quot;current&quot;: &quot;%EnemyDefaults:health&quot;</div>
<div class="line">        },</div>
<div class="line">        &quot;Velocity&quot;: {</div>
<div class="line">          &quot;speed&quot;: 8.0,  // Override default</div>
<div class="line">          &quot;direction&quot;: {&quot;x&quot;: 1, &quot;y&quot;: 0}</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Loading code</span></div>
<div class="line">JsonObject config = load_json(<span class="stringliteral">&quot;config.json&quot;</span>);</div>
<div class="line">JsonObject boss_obj = config[<span class="stringliteral">&quot;entities&quot;</span>][<span class="stringliteral">&quot;boss&quot;</span>][<span class="stringliteral">&quot;components&quot;</span>][<span class="stringliteral">&quot;Health&quot;</span>];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> max_health = get_value_copy&lt;int&gt;(r, boss_obj, <span class="stringliteral">&quot;max&quot;</span>);</div>
<div class="line"><span class="comment">// Resolves &quot;%EnemyDefaults:health&quot; -&gt; 100</span></div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_follower"></a>
Follower AI</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;entities&quot;: {</div>
<div class="line">    &quot;player&quot;: {</div>
<div class="line">      &quot;id&quot;: 1,</div>
<div class="line">      &quot;components&quot;: {</div>
<div class="line">        &quot;Position&quot;: {&quot;x&quot;: 100, &quot;y&quot;: 200}</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    &quot;companion&quot;: {</div>
<div class="line">      &quot;id&quot;: 2,</div>
<div class="line">      &quot;components&quot;: {</div>
<div class="line">        &quot;Follower&quot;: {</div>
<div class="line">          &quot;target_pos&quot;: &quot;#Player:pos&quot;,  // Dynamic binding!</div>
<div class="line">          &quot;offset&quot;: {&quot;x&quot;: -20, &quot;y&quot;: 0}</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// Component implementation</span></div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structFollower.html">Follower</a> {</div>
<div class="line">  <a class="code hl_class" href="classVector2D.html">Vector2D</a> target_pos;</div>
<div class="line">  <a class="code hl_class" href="classVector2D.html">Vector2D</a> offset;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structFollower.html#a68835e20b12cfe44a4c544536da7d659">Follower</a>(<a class="code hl_class" href="classRegistry.html">Registry</a>&amp; r, JsonObject <span class="keyword">const</span>&amp; obj, <a class="code hl_typedef" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> self)</div>
<div class="line">    : target_pos(<a class="code hl_function" href="Hooks_8hpp.html#ac691828d534a0e4dd453f2419b40c4bf">get_value</a>&lt;<a class="code hl_struct" href="structFollower.html">Follower</a>, <a class="code hl_class" href="classVector2D.html">Vector2D</a>&gt;(</div>
<div class="line">        r, obj, self, <span class="stringliteral">&quot;target_pos&quot;</span></div>
<div class="line">      ).value_or(<a class="code hl_class" href="classVector2D.html">Vector2D</a>{0, 0}))</div>
<div class="line">    , offset(<a class="code hl_function" href="Hooks_8hpp.html#adb9a223334bc754df5bf32b6f41e5b31">get_value_copy</a>&lt;<a class="code hl_class" href="classVector2D.html">Vector2D</a>&gt;(r, obj, <span class="stringliteral">&quot;offset&quot;</span>)</div>
<div class="line">      .value_or(<a class="code hl_class" href="classVector2D.html">Vector2D</a>{0, 0}))</div>
<div class="line">  {}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// After loading:</span></div>
<div class="line"><span class="comment">// - Companion&#39;s target_pos initially set to Player&#39;s position</span></div>
<div class="line"><span class="comment">// - Binding registered: Follower.target_pos &lt;- Player.pos</span></div>
<div class="line"><span class="comment">// - When Player moves, Companion&#39;s target_pos auto-updates</span></div>
<div class="ttc" id="aHooks_8hpp_html_ac691828d534a0e4dd453f2419b40c4bf"><div class="ttname"><a href="Hooks_8hpp.html#ac691828d534a0e4dd453f2419b40c4bf">get_value</a></div><div class="ttdeci">std::optional&lt; T &gt; get_value(Registry &amp;r, JsonObject const &amp;object, Registry::Entity entity, std::string const &amp;field_name, Args &amp;&amp;... args)</div><div class="ttdoc">Gets a value and registers a dynamic binding for auto-updates.</div><div class="ttdef"><b>Definition</b> Hooks.hpp:682</div></div>
<div class="ttc" id="aHooks_8hpp_html_adb9a223334bc754df5bf32b6f41e5b31"><div class="ttname"><a href="Hooks_8hpp.html#adb9a223334bc754df5bf32b6f41e5b31">get_value_copy</a></div><div class="ttdeci">std::optional&lt; T &gt; get_value_copy(Registry &amp;r, JsonObject const &amp;object, std::string const &amp;key, Args &amp;&amp;... args)</div><div class="ttdoc">Gets a copy of a value from JSON, supporting hooks and construction.</div><div class="ttdef"><b>Definition</b> Hooks.hpp:577</div></div>
<div class="ttc" id="aclassVector2D_html"><div class="ttname"><a href="classVector2D.html">Vector2D</a></div><div class="ttdoc">Two-dimensional vector with mathematical operations.</div><div class="ttdef"><b>Definition</b> Vector2D.hpp:43</div></div>
<div class="ttc" id="astructFollower_html"><div class="ttname"><a href="structFollower.html">Follower</a></div><div class="ttdef"><b>Definition</b> Follower.hpp:11</div></div>
<div class="ttc" id="astructFollower_html_a68835e20b12cfe44a4c544536da7d659"><div class="ttname"><a href="structFollower.html#a68835e20b12cfe44a4c544536da7d659">Follower::Follower</a></div><div class="ttdeci">Follower()</div><div class="ttdef"><b>Definition</b> Follower.hpp:12</div></div>
</div><!-- fragment --><h2><a class="anchor" id="hooks_weapon"></a>
Weapon System</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;weapons&quot;: {</div>
<div class="line">    &quot;pistol&quot;: {</div>
<div class="line">      &quot;damage&quot;: 10,</div>
<div class="line">      &quot;fire_rate&quot;: 2.0,</div>
<div class="line">      &quot;projectile&quot;: {</div>
<div class="line">        &quot;components&quot;: {</div>
<div class="line">          &quot;Velocity&quot;: {</div>
<div class="line">            &quot;speed&quot;: {&quot;x&quot;: &quot;#Player:velocity.speed.x&quot;, &quot;y&quot;: 0},</div>
<div class="line">            &quot;direction&quot;: {&quot;x&quot;: 1, &quot;y&quot;: 0}</div>
<div class="line">          },</div>
<div class="line">          &quot;Damage&quot;: {</div>
<div class="line">            &quot;value&quot;: &quot;%pistol:damage&quot;  // Reference weapon config</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="hooks_implementation"></a>
Implementation Details</h1>
<h2><a class="anchor" id="hooks_resolution"></a>
Resolution Process</h2>
<ol type="1">
<li><b>Check string prefix</b>:<ul>
<li><code>#</code> -&gt; Dynamic hook (register binding)</li>
<li><code>%</code> -&gt; Static hook (read once)</li>
<li>Neither -&gt; Try direct value or JSON construction</li>
</ul>
</li>
<li><b>Parse hook reference</b>:<ul>
<li>Format: "ComponentName:fieldName"</li>
<li>Split on first <code>:</code> to get component and field</li>
</ul>
</li>
<li><b>Lookup value</b>:<ul>
<li>Call Registry::get_hooked_value&lt;T&gt;(component, field)</li>
<li>Returns std::optional&lt;std::reference_wrapper&lt;const T&gt;&gt;</li>
</ul>
</li>
<li><b>Register binding</b> (dynamic hooks only):<ul>
<li>Call Registry::register_binding&lt;ComponentType, T&gt;(entity, field, hook)</li>
<li>Creates live connection between source and target</li>
</ul>
</li>
<li><b>Return value</b>:<ul>
<li>get_ref: Returns reference (optional&lt;reference_wrapper&gt;)</li>
<li>get_value_copy: Returns copy (optional&lt;T&gt;)</li>
<li>get_value: Returns copy + registers binding</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="hooks_errors"></a>
Error Handling</h2>
<p>All functions return std::optional:</p><ul>
<li><b>Success</b>: optional contains value</li>
<li><b>Failure</b>: optional is empty (nullopt)</li>
</ul>
<p>Failure cases:</p><ul>
<li>Key not found in JSON object</li>
<li>Hook reference invalid (bad format, component not found)</li>
<li>Type mismatch (requested type != actual type)</li>
<li>bad_variant_access, bad_any_cast, out_of_range</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">auto</span> value = get_value_copy&lt;int&gt;(r, obj, <span class="stringliteral">&quot;missing_key&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!value) {</div>
<div class="line">  <span class="comment">// Handle error: key not found or type mismatch</span></div>
<div class="line">  <span class="keywordtype">int</span> default_value = 0;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="keywordtype">int</span> actual_value = value.value();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or use value_or for defaults</span></div>
<div class="line"><span class="keywordtype">int</span> speed = get_value_copy&lt;int&gt;(r, obj, <span class="stringliteral">&quot;speed&quot;</span>).value_or(10);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="HookMacros_8hpp.html" title="Hook registration macros for component introspection.">HookMacros.hpp</a> for <a class="el" href="HookMacros_8hpp.html#a8f0cb5d5dff2b9cbbd63e1e50cc30e6a" title="Makes a component type hookable by generating a static hook map.">HOOKABLE()</a>, <a class="el" href="HookMacros_8hpp.html#a64db554aa76425e63b60d0fd6ccb1e26" title="Registers a component field using its variable name as the hook key.">HOOK()</a>, <a class="el" href="HookMacros_8hpp.html#a8bbce773ce13c61b2cb949332d6d2ec4" title="Registers a component field with a custom hook name.">HOOK_CUSTOM()</a> macros </dd>
<dd>
<a class="el" href="HookConcept_8hpp.html" title="Concept definition for hookable component types.">HookConcept.hpp</a> for <a class="el" href="concepthookable.html" title="Requires a type to provide a static hook_map() method.">hookable</a> type requirements </dd>
<dd>
<a class="el" href="classRegistry.html#a3c5b1d39982cf8c8a5159f048478faf9" title="Retrieve a reference to a hooked component field.">Registry::get_hooked_value()</a> for hook value retrieval </dd>
<dd>
<a class="el" href="classRegistry.html#a529bdf9002188825f7b03f33b2991624" title="Registers a dynamic binding between component fields.">Registry::register_binding()</a> for dynamic binding registration </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a978c2837387286f95b5dd502a61a74e3" name="a978c2837387286f95b5dd502a61a74e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a978c2837387286f95b5dd502a61a74e3">&#9670;&#160;</a></span>get_ref()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; std::reference_wrapper&lt; const <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; &gt; get_ref </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRegistry.html">Registry</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject const &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves a const reference to a value from JSON, resolving hooks. </p>
<p>Attempts to extract a value of type T from a JSON object at the specified key. If the value is a hook string (starts with # or %), resolves it to the component field reference. Otherwise, returns a reference to the JSON value.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The expected type of the value </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td><a class="el" href="classRegistry.html" title="The Registry class is the core of the ECS (Entity-Component-System) architecture.">Registry</a> instance for hook resolution </td></tr>
    <tr><td class="paramname">object</td><td>JSON object containing the key </td></tr>
    <tr><td class="paramname">key</td><td>Key name to lookup</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Optional reference wrapper to the value, or nullopt on failure</dd></dl>
<p>Resolution priority:</p><ol type="1">
<li>Check if value is a string starting with # or %</li>
<li>If so, parse as "ComponentName:fieldName" and resolve via <a class="el" href="classRegistry.html" title="The Registry class is the core of the ECS (Entity-Component-System) architecture.">Registry</a></li>
<li>If not a hook, try direct type extraction from JSON variant</li>
<li>Return nullopt if key missing or type mismatch</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>Returns a reference, not a copy - value lifetime tied to source </dd>
<dd>
For hooks, reference points to component field (updated if dynamic) </dd>
<dd>
For direct values, reference points to JSON storage (immutable)</dd></dl>
<div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;speed&quot;</span>] = 10.5;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> ref = get_ref&lt;double&gt;(r, obj, <span class="stringliteral">&quot;speed&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (ref) {</div>
<div class="line">  <span class="keywordtype">double</span> speed = ref-&gt;get();  <span class="comment">// 10.5</span></div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;max_health&quot;</span>] = <span class="stringliteral">&quot;%PlayerConfig:baseHealth&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Assuming PlayerConfig component has baseHealth = 100</span></div>
<div class="line"><span class="keyword">auto</span> ref = get_ref&lt;int&gt;(r, obj, <span class="stringliteral">&quot;max_health&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (ref) {</div>
<div class="line">  <span class="keywordtype">int</span> health = ref-&gt;get();  <span class="comment">// 100</span></div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;target&quot;</span>] = <span class="stringliteral">&quot;#Enemy:pos&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> ref = get_ref&lt;Vector2D&gt;(r, obj, <span class="stringliteral">&quot;target&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (ref) {</div>
<div class="line">  <a class="code hl_class" href="classVector2D.html">Vector2D</a> pos = ref-&gt;get();  <span class="comment">// Current enemy position</span></div>
<div class="line">  <span class="comment">// Note: reference may update if binding is registered elsewhere</span></div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ac691828d534a0e4dd453f2419b40c4bf" name="ac691828d534a0e4dd453f2419b40c4bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac691828d534a0e4dd453f2419b40c4bf">&#9670;&#160;</a></span>get_value()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ComponentType , typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> , typename... Args&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; get_value </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRegistry.html">Registry</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject const &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a>&#160;</td>
          <td class="paramname"><em>entity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a value and registers a dynamic binding for auto-updates. </p>
<p>Retrieves a value from JSON with full hook support, including dynamic binding registration. When the value is a dynamic hook (# prefix), this function registers a binding that auto-updates the target component field whenever the source changes.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">ComponentType</td><td>The component type containing the field (for binding) </td></tr>
    <tr><td class="paramname">T</td><td>The field value type </td></tr>
    <tr><td class="paramname">Args</td><td>Additional constructor arguments </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td><a class="el" href="classRegistry.html" title="The Registry class is the core of the ECS (Entity-Component-System) architecture.">Registry</a> instance </td></tr>
    <tr><td class="paramname">object</td><td>JSON object containing the key </td></tr>
    <tr><td class="paramname">entity</td><td>Entity that owns the component (for binding registration) </td></tr>
    <tr><td class="paramname">field_name</td><td>Name of the field in ComponentType (for binding registration) </td></tr>
    <tr><td class="paramname">args</td><td>Additional constructor arguments</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Optional containing the value, or nullopt on failure</dd></dl>
<p>Hook types:</p><ul>
<li>**# prefix**: Dynamic hook - registers binding for auto-updates</li>
<li><b>% prefix</b>: Static hook - reads value once, no binding</li>
<li><b>No prefix</b>: Direct value or JSON construction</li>
</ul>
<p>Binding registration (# hooks only): </p><div class="fragment"><div class="line">r.register_binding&lt;ComponentType, <a class="code hl_enumvalue" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a>&gt;(</div>
<div class="line">  entity,</div>
<div class="line">  field_name,</div>
<div class="line">  <span class="stringliteral">&quot;SourceComponent:sourceField&quot;</span></div>
<div class="line">);</div>
<div class="ttc" id="aIoEvents_8hpp_html_a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce"><div class="ttname"><a href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a></div><div class="ttdeci">@ T</div><div class="ttdef"><b>Definition</b> IoEvents.hpp:53</div></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>This function should be called from component constructors </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Use <a class="el" href="Hooks_8hpp.html#adb9a223334bc754df5bf32b6f41e5b31" title="Gets a copy of a value from JSON, supporting hooks and construction.">get_value_copy()</a> if dynamic binding is not needed </dd>
<dd>
Empty T{} returned if hook exists but no mapped entities found</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structFollower.html">Follower</a> {</div>
<div class="line">  <a class="code hl_class" href="classVector2D.html">Vector2D</a> target_pos;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structFollower.html#a68835e20b12cfe44a4c544536da7d659">Follower</a>(<a class="code hl_class" href="classRegistry.html">Registry</a>&amp; r, JsonObject <span class="keyword">const</span>&amp; obj, <a class="code hl_typedef" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> self) {</div>
<div class="line">    <span class="comment">// JSON: &quot;target_pos&quot;: &quot;#Leader:pos&quot;</span></div>
<div class="line">    target_pos = get_value&lt;Follower, Vector2D&gt;(</div>
<div class="line">      r, obj, self, <span class="stringliteral">&quot;target_pos&quot;</span></div>
<div class="line">    ).value_or(<a class="code hl_class" href="classVector2D.html">Vector2D</a>{0, 0});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Binding registered: Follower.target_pos &lt;- Leader.pos</span></div>
<div class="line">    <span class="comment">// target_pos will auto-update when Leader moves</span></div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">struct </span>Enemy {</div>
<div class="line">  <span class="keywordtype">int</span> max_health;</div>
<div class="line"> </div>
<div class="line">  Enemy(<a class="code hl_class" href="classRegistry.html">Registry</a>&amp; r, JsonObject <span class="keyword">const</span>&amp; obj, <a class="code hl_typedef" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> self) {</div>
<div class="line">    <span class="comment">// JSON: &quot;max_health&quot;: &quot;%EnemyDefaults:health&quot;</span></div>
<div class="line">    max_health = get_value&lt;Enemy, int&gt;(</div>
<div class="line">      r, obj, self, <span class="stringliteral">&quot;max_health&quot;</span></div>
<div class="line">    ).value_or(100);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// No binding registered - value read once</span></div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_class" href="classProjectile.html">Projectile</a> {</div>
<div class="line">  <span class="keywordtype">int</span> damage;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classProjectile.html">Projectile</a>(<a class="code hl_class" href="classRegistry.html">Registry</a>&amp; r, JsonObject <span class="keyword">const</span>&amp; obj, <a class="code hl_typedef" href="classRegistry.html#a0f7878e7be2d225f4f7ca38b85911110">Registry::Entity</a> self) {</div>
<div class="line">    <span class="comment">// JSON: &quot;damage&quot;: 25</span></div>
<div class="line">    damage = get_value&lt;Projectile, int&gt;(</div>
<div class="line">      r, obj, self, <span class="stringliteral">&quot;damage&quot;</span></div>
<div class="line">    ).value_or(10);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="aclassProjectile_html"><div class="ttname"><a href="classProjectile.html">Projectile</a></div><div class="ttdef"><b>Definition</b> Projectile.hpp:10</div></div>
</div><!-- fragment --> 
</div>
</div>
<a id="adb9a223334bc754df5bf32b6f41e5b31" name="adb9a223334bc754df5bf32b6f41e5b31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9a223334bc754df5bf32b6f41e5b31">&#9670;&#160;</a></span>get_value_copy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> , typename... Args&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; get_value_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRegistry.html">Registry</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">JsonObject const &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a copy of a value from JSON, supporting hooks and construction. </p>
<p>Retrieves a value of type T from a JSON object, with support for:</p><ul>
<li>Direct JSON values (int, double, string, bool, object, array)</li>
<li>Static hook references (% prefix)</li>
<li>Dynamic hook references (# prefix) - reads value but doesn't bind</li>
<li>JSON object construction (if T has JsonObject constructor)</li>
</ul>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>The expected type of the value </td></tr>
    <tr><td class="paramname">Args</td><td>Additional constructor arguments for JSON construction </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td><a class="el" href="classRegistry.html" title="The Registry class is the core of the ECS (Entity-Component-System) architecture.">Registry</a> instance for hook resolution </td></tr>
    <tr><td class="paramname">object</td><td>JSON object containing the key </td></tr>
    <tr><td class="paramname">key</td><td>Key name to lookup </td></tr>
    <tr><td class="paramname">args</td><td>Additional arguments passed to T's constructor (if needed)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Optional containing a copy of the value, or nullopt on failure</dd></dl>
<p>Resolution priority:</p><ol type="1">
<li>Try <a class="el" href="Hooks_8hpp.html#a978c2837387286f95b5dd502a61a74e3" title="Retrieves a const reference to a value from JSON, resolving hooks.">get_ref&lt;T&gt;()</a> for direct value or hook</li>
<li>If successful, return a copy of the referenced value</li>
<li>If T is constructible from JsonObject, try JSON construction</li>
<li>Return nullopt if all methods fail</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>Always returns a copy - caller owns the returned value </dd>
<dd>
For static hooks only - dynamic binding requires <a class="el" href="Hooks_8hpp.html#ac691828d534a0e4dd453f2419b40c4bf" title="Gets a value and registers a dynamic binding for auto-updates.">get_value()</a></dd></dl>
<div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;damage&quot;</span>] = 50;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> damage = get_value_copy&lt;int&gt;(r, obj, <span class="stringliteral">&quot;damage&quot;</span>);</div>
<div class="line"><span class="comment">// damage == optional&lt;int&gt;(50)</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;speed&quot;</span>] = <span class="stringliteral">&quot;%Config:playerSpeed&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> speed = get_value_copy&lt;double&gt;(r, obj, <span class="stringliteral">&quot;speed&quot;</span>);</div>
<div class="line"><span class="comment">// Reads Config::playerSpeed and returns a copy</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;rect&quot;</span>] = JsonObject{</div>
<div class="line">  {<span class="stringliteral">&quot;x&quot;</span>, 10}, {<span class="stringliteral">&quot;y&quot;</span>, 20}, {<span class="stringliteral">&quot;w&quot;</span>, 100}, {<span class="stringliteral">&quot;h&quot;</span>, 50}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> rect = get_value_copy&lt;Rect&gt;(r, obj, <span class="stringliteral">&quot;rect&quot;</span>);</div>
<div class="line"><span class="comment">// Calls Rect(JsonObject) constructor</span></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">auto</span> health = get_value_copy&lt;int&gt;(r, obj, <span class="stringliteral">&quot;health&quot;</span>).value_or(100);</div>
<div class="line"><span class="comment">// Returns 100 if &quot;health&quot; key missing or invalid</span></div>
</div><!-- fragment --> 
</div>
</div>
<a id="a7f31f364a4ef0cbffcdb592482c79562" name="a7f31f364a4ef0cbffcdb592482c79562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f31f364a4ef0cbffcdb592482c79562">&#9670;&#160;</a></span>is_hook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_hook </td>
          <td>(</td>
          <td class="paramtype">JsonObject const &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if a JSON value is a dynamic hook reference. </p>
<p>Determines whether a JSON object key contains a dynamic hook string (starts with # character). Static hooks (% prefix) return false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object</td><td>JSON object to check </td></tr>
    <tr><td class="paramname">key</td><td>Key name to examine</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if value is a string starting with #, false otherwise</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Only detects dynamic hooks (#), not static hooks (%) </dd>
<dd>
Returns false for non-string values or missing keys</dd></dl>
<div class="fragment"><div class="line">JsonObject obj;</div>
<div class="line">obj[<span class="stringliteral">&quot;direct&quot;</span>] = 100;</div>
<div class="line">obj[<span class="stringliteral">&quot;static&quot;</span>] = <span class="stringliteral">&quot;%Config:value&quot;</span>;</div>
<div class="line">obj[<span class="stringliteral">&quot;dynamic&quot;</span>] = <span class="stringliteral">&quot;#Player:pos&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;direct&quot;</span>);   <span class="comment">// false - not a string</span></div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;static&quot;</span>);   <span class="comment">// false - % prefix, not #</span></div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;dynamic&quot;</span>);  <span class="comment">// true - # prefix</span></div>
<div class="line"><a class="code hl_function" href="Hooks_8hpp.html#a7f31f364a4ef0cbffcdb592482c79562">is_hook</a>(obj, <span class="stringliteral">&quot;missing&quot;</span>);  <span class="comment">// false - key doesn&#39;t exist</span></div>
</div><!-- fragment --> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aba47387628b78f33fcb6471473b636d2" name="aba47387628b78f33fcb6471473b636d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba47387628b78f33fcb6471473b636d2">&#9670;&#160;</a></span>is_in_json_variant_v</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename <a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a> &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">is_in_json_variant_v = <a class="el" href="structis__in__json__variant.html">is_in_json_variant</a>&lt;<a class="el" href="IoEvents_8hpp.html#a9479d299e1852e6140dcca1f405868aba21f40778b7db9343a6ca75ec2c41ccce">T</a>&gt;::value</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convenience variable template for <a class="el" href="structis__in__json__variant.html" title="Type trait to check if T is a valid JSON variant type.">is_in_json_variant</a>. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Type to check </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
